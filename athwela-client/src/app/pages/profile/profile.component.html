<div class="container">
    <div class="row mt-5">
        <div class="col-md-12  mt-2 mt-md-0">
            <h1 class="mb-5">
                {{ user?.name }}
            </h1>
        </div>
        <div class="col-md-3 mt-2 mt-md-0">
            <div class="card text-center">
                <div class="card-body">
                    <img *ngIf="user.avatar" class="image-cover" [src]="user.avatar" data-holder-rendered="true">
                    <img *ngIf="!user.avatar" class="image-cover" src="assets/user.png" data-holder-rendered="true">
                    <h5 class="card-title mt-4">{{ user?.username }}</h5>
                    <p class="card-text">{{ user?.email }}</p>
                    <button class="btn btn-default">Ratings</button>
                    <button (click)="openSettings(settings)" class="btn btn-primary" *ngIf="!visitor">Settings</button>
                </div>
            </div>
        </div>

        <div class="col-md-9 mt-2 mt-md-0">
            <h3 *ngIf="!visitor" class="mb-3 mt-4 mt-md-0">My Campaigns</h3>
            <h3 *ngIf="visitor" class="mb-3 mt-4 mt-md-0">Campaigns</h3>
            <div class="row mt-2">
                <div *ngFor="let cmp of campaigns" class="col-lg-6 col-sm-12 my-2">
                    <app-campaign-card id={{cmp._id}} name={{cmp.name}} description={{cmp.description}}
                        raised={{cmp.raised}} target={{cmp.target}} [hideDonate]="true">
                    </app-campaign-card>
                </div>
                <div class="col-md-12">
                    <div class="card shadow" style="width: 100%;" *ngIf="noCampaigns">
                        <div class="card-body text-center">
                            <p class="card-text my-4">
                                Nothing here yet..
                            </p>
                            <a href="#" class="btn btn-primary mb-4" *ngIf=[!visitor]>Start a fundraising campaign</a>
                        </div>
                    </div>
                </div>
            </div>

            <h3 *ngIf="!visitor" class="mb-3 mt-4">My Donations</h3>
            <h3 *ngIf="visitor" class="mb-3 mt-4">Donations</h3>
            <div class="row mb-2 mt-4">
                <div class="col-md-12" *ngIf="noDonations">
                    <div class="card shadow" style="width: 100%;">
                        <div class="card-body text-center">
                            <p class="card-text my-4">
                                Nothing here yet..
                            </p>
                            <a href="#" class="btn btn-primary mb-4" *ngIf=[!visitor]>Make a donation</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<app-footer></app-footer>

<ng-template #settings>
    <div class="modal-header">
        <h4 class="modal-titile pull-left">Settings</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="bsModalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>

    <form (submit)="onUpdateSubmit()">
        <div class="modal-body">
            <div class="form-group">
                <label for="inputUsername">Username</label>
                <input type="text" disabled name="username" class="form-control" id="inputUsername"
                    aria-describedby="usernameHelp" [placeholder]="user?.username">
                <small id="usernameHelp" class="form-text text-muted">You can't change your username.</small>
            </div>

            <div class="form-group">
                <label for="inputName">Name</label>
                <input type="text" [(ngModel)]="name" name="name" class="form-control" id="inputName"
                    aria-describedby="nameHelp" [placeholder]="user?.name" [ngClass]="{ 'is-invalid': nameInvalid }">
            </div>

            <div class="form-group">
                <label for="inputAvatar">Avatar</label><br />
                <input type="file" ng2FileSelect [uploader]="uploader" class="mt-2" id="inputAvatar" />
                <button type="button" class="btn btn-success btn-s" (click)="uploader.uploadAll()"
                    [disabled]="!uploader.getNotUploadedItems().length">Upload</button>
                <small class="form-text text-muted">
                    Select a photo and upload it to add or change your avatar.
                </small>
            </div>

            <div class="form-group">
                <label for="inputEmail">Email address</label>
                <input type="email" [(ngModel)]="email" name="email" class="form-control" id="inputEmail"
                    [placeholder]="user?.email" [ngClass]="{ 'is-invalid': emailInvalid }">
                <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone
                    else.</small>
            </div>


            <div class="form-group">
                <label for="inputPassword">Password</label>
                <input type="password" [(ngModel)]="password" name="password" class="form-control" id="inputPassword"
                    placeholder="Enter a new password" [ngClass]="{ 'is-invalid': passwordInvalid }"
                    aria-describedby="passwordHelp">
                <password-strength-meter id="passwordHelp" [enableFeedback]="true" [password]="password">
                </password-strength-meter>
            </div>
            <div class="form-group">
                <input type="password" [(ngModel)]="passwordConfirm" name="password-confirm" class="form-control"
                    id="inputPasswordConfirm" placeholder="Enter your new password again for confirmation"
                    [ngClass]="{ 'is-invalid': passwordMismatch || passwordInvalid }" aria-describedby="passwordHelp">
                <small id="passwordHelp" class="form-text text-muted">
                    If you don't want to change your password, keep
                    these fields empty.
                </small>
            </div>

            <div *ngFor="let alert of alerts">
                <alert [type]="alert.type"><span [innerHtml]="alert.msg"></span></alert>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-default" (click)="modalRef.hide()">Close</button>
            <button type="submit" class="btn btn-primary">Update</button>
        </div>
    </form>
</ng-template>